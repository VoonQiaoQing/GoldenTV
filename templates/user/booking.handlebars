<style>
    body {
    background: rgb(0, 0, 0)
}

#regForm {
    background-color: gold;
    margin: 0px auto;
    font-family: Raleway;
    padding: 40px;
    border-radius: 10px
}

#register {
    color: #000000
}

h1 {
    text-align: center
}

.details {
    padding: 10px;
    width: 100%;
    font-size: 17px;
    font-family: Raleway;
    border: 1px solid #aaaaaa;
    border-radius: 10px;
    -webkit-appearance: none
}
#pay{
    width: 20%
}

.tab input:focus {
    border: 1px solid #6a1b9a !important;
    outline: none
}

input.invalid {
    border: 1px solid #e03a0666
}

.tab {
    display: none
}

button {
    background-color: #000000;
    color: #ffffff;
    border: none;
    border-radius: 50%;
    padding: 10px 20px;
    font-size: 17px;
    font-family: Raleway;
    cursor: pointer
}

button:hover {
    opacity: 0.8
}

button:focus {
    outline: none !important
}

#prevBtn {
    background-color: #bbbbbb
}

.all-steps {
    text-align: center;
    margin-top: 30px;
    margin-bottom: 30px;
    width: 100%;
    display: inline-flex;
    justify-content: center
}

.step {
    height: 40px;
    width: 40px;
    margin: 0 2px;
    background-color: #bbbbbb;
    border: none;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 15px;
    color: #000000;
    opacity: 0.5
}

.step.active {
    opacity: 1
}

.step.finish {
    color: #fff;
    background: #000000;
    opacity: 1
}

.all-steps {
    text-align: center;
    margin-top: 30px;
    margin-bottom: 30px
}

.thanks-message {
    display: none
}
</style>
<style>
    table,
    td,
    th {
        border: 1px solid black;
    }

    table {
        border-collapse: collapse;
    }
</style>
<div class="container mt-5">
    <div class="row d-flex justify-content-center align-items-center">
        <div class="col-md-8">
            <form id="regForm" action="/user/payment/{{choice}}" method="post" >
                <h1 id="register">Booking Room for {{choice}}</h1>
                <div class="all-steps" id="all-steps"> <span class="step"><i class="far fa-map"></i></span> <span
                        class="step"><i class="far fa-calendar"></i></span><span class="step"><i class="fa fa-clock-o"></i></span> <span class="step"><i
                            class="fas fa-couch"></i></span><span class="step"><i class="fas fa-check"></i></span> </div>
                <div class="tab">
                    <h5>Choose the <bold>location:</bold></h5>
                    <p> 
                        <select  class="details" id="venue" name="location"  onmouseover="myFunction()">
                            {{#each location}}
                        <option >{{this}}</option>
                        {{/each}}
                    </select></p>
                </div>
                <div class="tab">
                    <h5>Choose the <bold>Date:</bold></h5>
                    <select name="date" class="details" onmouseover="mydate()" id="date">
                    </select>
                    <p></p>
                </div>
                <div class="tab">
                    <h5>Choose the <bold>Timeslot:</bold></h5>
                    <select name="time" class="details" onmouseover="mytime()" id="time">
            
                    </select>
                </div>
                <div class="tab">
                    <h5>Choose the <bold>Room Size:</bold></h5>
                    <select name="room" class="details" id="room" onmouseover="myroom()">
                    
                    </select>
                </div>
                <div class="tab">
                    <h5>Confirm your booking details</h5>
                    <table>
                        <tr>
                            <th>location</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Room Size</th>
                        </tr>
                        <tr>
                            <td id="location"></td>
                            <td id="showdate"></td>
                            <td id="timeslot"></td>
                            <td id="roomtype"></td>
                        </tr>
                    </table>
                </div>
                <div style="overflow:auto;" id="nextprevious">
                    <div style="float:right;"> <button type="button" id="prevBtn" onclick="nextPrev(-1)"><i
                                class="fa fa-angle-double-left"></i></button> <button type="button" id="nextBtn"
                            onclick="nextPrev(1)"><i class="fa fa-angle-double-right"></i></button> </div>
                </div>
            </form>
        </div>
    </div>
    <script>
        async function myFunction() {
            const response = await fetch("/user/date", {
                headers: {
                    "Content-Type": "application/json"
                },
                method: "POST",
                body: JSON.stringify({
                    location: document.getElementById("venue").value
                })
            });
            if (response.ok) {
                const content = await response.json();
                showdate(content.date);
            }
        }
        function showdate(date) {
           console.log(date);
            var x = document.getElementById("date");
            var option = document.createElement("option");
            for (let i = 0; i < date.length; i++) {
                option.text = date[i];
                x.add(option)
            }
        }
    </script>
        <script>
            async function mydate() {
                const response = await fetch("/user/time", {
                    headers: {
                        "Content-Type": "application/json"
                    },
                    method: "POST",
                    body: JSON.stringify({
                        location: document.getElementById("venue").value,
                        date: document.getElementById("date").value
                    })
                });
                if (response.ok) {
                    const content = await response.json();
                    showtime(content.time);
                }
            }
            function showtime(time) {
                var x = document.getElementById("time");
                var option = document.createElement("option");
                for (let i = 0; i < time.length; i++) {
                    option.text = time[i];
                    x.add(option)
                }
            }
        </script>
        <script>
            async function mytime() {
                const response = await fetch("/user/roomtype", {
                    headers: {
                        "Content-Type": "application/json"
                    },
                    method: "POST",
                    body: JSON.stringify({
                        location: document.getElementById("venue").value,
                        date: document.getElementById("date").value,
                        time: document.getElementById("time").value
                    })
                });
                if (response.ok) {
                    const content = await response.json();
                    someroom(content.room);
                }
            }
            function someroom(room) {
                var x = document.getElementById("room");
                var option = document.createElement("option");
                for (let i = 0; i < room.length; i++) {
                    option.text = room[i];
                    x.add(option)
                }
            }
        </script>
        <script>
            async function myroom() {
                        var l = document.getElementById("venue").value;
                        var d = document.getElementById("date").value;
                        var t =  document.getElementById("time").value;
                        var r = document.getElementById("room").value;
                        document.getElementById("location").innerHTML = l;
                        document.getElementById("showdate").innerHTML = d;
                        document.getElementById("timeslot").innerHTML = t;
                        document.getElementById("roomtype").innerHTML = r;

            }
        </script>
<script>
    var currentTab = 0;
        document.addEventListener("DOMContentLoaded", function (event) {
            showTab(currentTab);

        });

        function showTab(n) {
            var x = document.getElementsByClassName("tab");
            x[n].style.display = "block";
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            
            if (n == 1) {
                document.getElementById("nextBtn").innerHTML = '<i class="fa fa-angle-double-right"></i>';
            } 
            
            fixStepIndicator(n)
        }

        function nextPrev(n) {
            var x = document.getElementsByClassName("tab");
            if (n == 1 && !validateForm()) return false;
            x[currentTab].style.display = "none";
            currentTab = currentTab + n;
            if (currentTab >= 4) {
                document.getElementById("nextprevious").innerHTML = "<input type='Submit' class='btn btn-primary pull-right' id='pay' value='Pay'>";
            
            }
            showTab(currentTab);
        }

        function validateForm() {
            var x, y, i, valid = true;
            x = document.getElementsByClassName("tab");
            y = x[currentTab].getElementsByTagName("input");
            for (i = 0; i < y.length; i++) { if (y[i].value == "") { y[i].className += " invalid"; valid = false; } } if (valid) { document.getElementsByClassName("step")[currentTab].className += " finish"; } return valid;
        } function fixStepIndicator(n) { var i, x = document.getElementsByClassName("step"); for (i = 0; i < x.length; i++) { x[i].className = x[i].className.replace(" active", ""); } x[n].className += " active"; }

</script>